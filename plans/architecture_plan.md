# Архитектурный план мобильного приложения для отслеживания менструального цикла

## 1. Обзор проекта

Мобильное приложение для отслеживания менструального цикла с календарем, системой уведомлений, статистикой и аналитикой. Приложение будет разработано с использованием последних версий React Native и Expo и React 19.

## 2. Функциональные требования

1. Основной экран с календарем (react-native-calendars)
2. Возможность отмечать дни менструации в календаре
3. Система уведомлений для предупреждения о наступлении следующих дней
4. Статистика и аналитика цикла
5. Хранение данных локально (SQLite для сложных данных, AsyncStorage для настроек)

## 3. Технические требования

- Функциональные компоненты с React Hooks
- React Navigation для навигации
- react-native-push-notification для уведомлений
- Nativewind для стилизации
- Поддержка светлой и темной темы

## 4. Архитектурные рекомендации

### 4.1. Слоистая архитектура

```
┌─────────────────┐
│      UI         │ ← Компоненты и экраны
├─────────────────┤
│ Business Logic  │ ← Сервисы, вычисления
├─────────────────┤
│     Data        │ ← Хранилище данных, модели
└─────────────────┘
```

### 4.2. Структура папок

```
src/
├── components/     # Переиспользуемые компоненты
├── screens/        # Экраны приложения
├── services/       # Бизнес-логика и API
├── models/         # Модели данных
├── utils/          # Вспомогательные функции
├── hooks/          # Кастомные хуки
├── styles/         # Стили и темы
└── navigation/     # Конфигурация навигации
```

### 4.3. Паттерны проектирования

- MobX для управления состоянием
- Custom hooks для повторно используемых функций
- Компоненты высшего порядка для общих функций

## 5. Подробный план разработки

### Этап 1: Анализ требований и проектирование архитектуры
- [x] Анализ функциональных и нефункциональных требований
- [x] Проектирование архитектуры приложения (слои, паттерны)
- [x] Создание диаграммы архитектуры

### Этап 2: Проектирование UI/UX
- [x] Создание wireframes и прототипов экранов
- [x] Определение пользовательских сценариев
- [x] Разработка гайдлайнов для дизайна

### Этап 3: Настройка проекта и зависимостей
- [x] Инициализация проекта React Native/Expo
- [x] Установка и настройка всех необходимых зависимостей
- [x] Настройка конфигурации сборки

### Этап 4: Выбор и реализация системы хранения данных
- [x] Сравнение AsyncStorage vs SQLite
- [x] Реализация выбранного решения
- [x] Создание слоя абстракции для работы с данными

### Этап 5: Разработка основных экранов
- [ ] Главный экран с календарем (react-native-calendars)
- [ ] Экран добавления/редактирования записей
- [ ] Экран статистики
- [ ] Экран настроек уведомлений

### Этап 6: Реализация бизнес-логики
- [ ] Отметка дней менструации в календаре
- [ ] Расчет средней продолжительности цикла
- [ ] Прогнозирование следующих дней
- [ ] Добавление заметок к дням

### Этап 7: Реализация уведомлений
- [ ] Интеграция react-native-push-notification
- [ ] Настройка планирования уведомлений
- [ ] Экран настроек уведомлений

### Этап 8: Интеграция стилизации и темизации
- [ ] Интеграция Nativewind
- [ ] Реализация светлой и темной темы
- [ ] Адаптация компонентов под темы

### Этап 9: Реализация навигации
- [ ] Настройка React Navigation
- [ ] Создание маршрутов приложения
- [ ] Обработка переходов между экранами

### Этап 10: Функция экспорта данных
- [ ] Реализация механизма экспорта
- [ ] Выбор формата экспорта (JSON, CSV)
- [ ] Интерфейс для экспорта

### Этап 11: Тестирование
- [ ] Юнит-тесты для бизнес-логики
- [ ] Тесты компонентов
- [ ] Интеграционное тестирование

### Этап 12: Документация
- [ ] Документация по установке и запуску
- [ ] Документация по API и архитектуре
- [ ] Руководство пользователя

### Этап 13: Финальная проверка и отладка
- [ ] Комплексное тестирование на разных устройствах
- [ ] Исправление багов
- [ ] Оптимизация производительности

## 6. Безопасность и приватность

- Защита чувствительных данных
- Локальное хранение без передачи в облако
- Возможность удаления данных пользователем

## 7. Зависимости проекта

```json
{
  "dependencies": {
    "expo": "~49.0.0",
    "react": "18.2.0",
    "react-native": "0.72.0",
    "react-native-calendars": "^1.1294.0",
    "react-native-push-notification": "^8.1.1",
    "nativewind": "^2.0.11",
    "@react-navigation/native": "^6.1.0",
    "@react-navigation/stack": "^6.3.0",
    "react-native-sqlite-storage": "^6.0.1",
    "@react-native-async-storage/async-storage": "^1.17.11",
    "mobx": "^6.8.0",
    "mobx-react-lite": "^3.4.0"
  },
  "devDependencies": {
    "@babel/core": "^7.20.0",
    "tailwindcss": "^3.3.0"
  }
}
```

## 8. Диаграмма архитектуры

```mermaid
graph TD
    A[UI Layer] --> B[BLL - Business Logic Layer]
    B --> C[Data Access Layer]
    C --> D[Local Storage - SQLite/AsyncStorage]
    
    E[Calendar Screen] --> A
    F[Statistics Screen] --> A
    G[Settings Screen] --> A
    
    H[Cycle Tracking Service] --> B
    I[Notification Service] --> B
    J[Export Service] --> B